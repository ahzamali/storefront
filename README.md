# StoreFront v2

> **Note**: This project was completely generated by **Antigravity**, an advanced AI coding assistant by Google DeepMind.

StoreFront v2 is a modern, hybrid retail management system designed to bridge the gap between central warehouses ("Master Stores") and pop-up retail locations ("Virtual Stores").

## üèó Architecture

The system is built as a monorepo containing three distinct components:

| Component | Tech Stack | Location | Description |
|-----------|------------|----------|-------------|
| **Server** | Spring Boot, H2 DB, Java 17 | `/server` | Central API, Auth, and Inventory management. |
| **Web** | React, Vite | `/web` | Admin dashboard for HQ inventory control. |
| **Android** | Kotlin, Jetpack Compose | `/android` | Point-of-Sale (POS) app for employees. |

## üöÄ Key Features

- **Master Inventory**: Centralized stock management with auto-seeding.
- **Real-Time Stock View**: Monitor inventory levels instantly from the web dashboard.
- **H2 Persistence**: File-based database storage that persists across restarts.
- **Virtual Stores**: Allocate stock to temporary locations for events/pop-ups.
- **Bundle Sales**: Sell product bundles with flexible exclusions.

## üì° API Reference

### Orders
- **Create Order**: `POST /api/v1/orders`
  - Body: `{ "storeId": 1, "items": [...], "customerName": "John", "customerPhone": "123" }`
- **Search Orders**: `GET /api/v1/orders`
  - Query Params:
    - `customerName`: Partial case-insensitive match.
    - `customerPhone`: Partial match.

### Inventory
- **Search Store Inventory**: `GET /api/v1/stores/{storeId}/inventory`
  - Query Params:
    - `search`: Matches Product Name OR ISBN (inside JSON attributes).

## üõ† Prerequisites

- **Java**: JDK 17 or higher.
- **Node.js**: v18+ (for Web Dashboard).
- **Android Studio**: For running the mobile app.

## üì¶ Getting Started

### 1. Backend Server

The server is the heart of the system. It uses an H2 file-based database.

```bash
cd server
mvn spring-boot:run
```

- **API URL**: `http://localhost:8080`
- **H2 Console**: `http://localhost:8080/h2-console`
  - JDBC URL: `jdbc:h2:file:./data/storefront;DB_CLOSE_DELAY=-1;MODE=PostgreSQL`
  - User: `sa` / Password: (empty)

### 2. Web Dashboard

The admin interface for managing the system.

```bash
cd web
npm install
npm run dev
```

- **URL**: `http://localhost:3000` (typically)
- **Login**: Use the admin credentials created during seeding (if applicable) or register a new admin via API if dev mode is open.

### 3. Android App

Open the `/android` folder in Android Studio and run on an emulator or device. Ensure the device serves as a bridge to `localhost` (e.g., using `adb reverse tcp:8080 tcp:8080`).

## üê≥ Docker Deployment

We provide a **Single Docker Image** deployment strategy where the backend serves the frontend.

### 1. Build the Bundle
Run the PowerShell script to build the frontend, embed it into the backend, and create the Docker image:

```powershell
.\build_deployment.ps1
```

This creates a local image: `storefront-v2:latest` (or `ghcr.io/...`).

### 2. Run with Docker Compose
To start the app with a persistent H2 database:

```bash
docker-compose up -d
```
Access the full app at **`http://localhost:8080`**.


### 3. Database Switching (H2 vs Postgres)
The `docker-compose.yml` is configured for **H2 by default**. To switch to **PostgreSQL**:
1. Open `docker-compose.yml`.
2. Comment out the `volumes` section (H2 data).
3. Uncomment the `environment` section and configure your Postgres credentials.

## üìä Code Statistics

**Total Lines of Code: 8,222**

| Component | Language | Files | Lines |
| :--- | :--- | :--- | :--- |
| **Android** | Kotlin (.kt) | 14 | 1,413 |
| (**1,448**) | XML (.xml) | 1 | 35 |
| **Server** | Java (.java) | 68 | 3,973 |
| (**3,973**) | | | |
| **Web** | JSX (.jsx) | 11 | 2,608 |
| (**2,801**) | JS (.js) | 2 | 97 |
| | CSS (.css) | 2 | 96 |

## ü§ñ Generated by Antigravity

This entire codebase, including feature implementations and debugging fixes, was orchestrated by Antigravity.
